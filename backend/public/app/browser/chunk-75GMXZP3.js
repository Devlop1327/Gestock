import{b as M,c as _,d as T,e as G,f as O,h as P,i as q,o as R,q as V}from"./chunk-7YMBZQR7.js";import{a as j}from"./chunk-RA2M532G.js";import{D as d,G as s,H as v,I as a,J as n,K as g,L as I,M as p,N as C,O as l,P as x,Q as h,ba as k,da as N,ja as D,la as w,q as S,r as E,w as r,y as c,z as y}from"./chunk-G2FCS2CP.js";import{a as F}from"./chunk-2NFLSA4Y.js";function B(o,i){if(o&1){let e=I();a(0,"div",17),l(1),a(2,"button",18),p("click",function(){S(e);let m=C();return E(m.error="")}),n()()}if(o&2){let e=C();r(),h(" ",e.error," ")}}function z(o,i){o&1&&(a(0,"div",19),l(1," El nombre es requerido "),n())}function L(o,i){o&1&&(a(0,"div",19),l(1," La descripci\xF3n es requerida "),n())}function H(o,i){o&1&&g(0,"span",20)}var A=class o{constructor(i,e,t,m){this.fb=i;this.categoriaService=e;this.router=t;this.route=m;this.categoriaForm=this.fb.group({nombre:["",[_.required]],descripcion:["",[_.required]]})}categoriaForm;submitting=!1;error="";idCategoria;esEdicion=!1;ngOnInit(){this.route.paramMap.subscribe(i=>{let e=i.get("id");e&&(this.esEdicion=!0,this.idCategoria=+e,this.cargarCategoria(this.idCategoria))})}cargarCategoria(i){this.categoriaService.getCategoria(i).subscribe({next:e=>{this.categoriaForm.patchValue(e)},error:()=>{this.error="No se pudo cargar la categor\xEDa"}})}onSubmit(){if(this.categoriaForm.valid){this.submitting=!0,this.error="";let i=F({},this.categoriaForm.value);this.esEdicion&&this.idCategoria?this.categoriaService.updateCategoria(this.idCategoria,i).subscribe({next:()=>{this.submitting=!1,this.router.navigate(["/categorias"])},error:()=>{this.submitting=!1,this.error="Error al actualizar la categor\xEDa"}}):this.categoriaService.createCategoria(i).subscribe({next:()=>{this.submitting=!1,this.router.navigate(["/categorias"])},error:()=>{this.submitting=!1,this.error="Error al crear la categor\xEDa"}})}else this.error="Por favor, complete todos los campos requeridos correctamente.",Object.keys(this.categoriaForm.controls).forEach(i=>{let e=this.categoriaForm.get(i);e?.invalid&&e.markAsTouched()})}goBack(){this.router.navigate(["/categorias"])}static \u0275fac=function(e){return new(e||o)(c(R),c(j),c(w),c(D))};static \u0275cmp=y({type:o,selectors:[["app-categoria-form"]],decls:24,vars:12,consts:[[1,"container"],[1,"card"],[1,"card-header","bg-primary","text-white"],[1,"mb-0"],[1,"card-body"],[1,"mt-4",3,"ngSubmit","formGroup"],["class","alert alert-danger alert-dismissible fade show","role","alert",4,"ngIf"],[1,"mb-3"],["for","nombre",1,"form-label"],["type","text","id","nombre","formControlName","nombre",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["for","descripcion",1,"form-label"],["id","descripcion","formControlName","descripcion","rows","3",1,"form-control"],[1,"d-flex","justify-content-end","mt-4"],["type","button",1,"btn","btn-secondary","me-2",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm me-1","role","status","aria-hidden","true",4,"ngIf"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"invalid-feedback"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-1"]],template:function(e,t){if(e&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),l(4),n()(),a(5,"div",4)(6,"form",5),p("ngSubmit",function(){return t.onSubmit()}),d(7,B,3,1,"div",6),a(8,"div",7)(9,"label",8),l(10,"Nombre *"),n(),g(11,"input",9),d(12,z,2,0,"div",10),n(),a(13,"div",7)(14,"label",11),l(15,"Descripci\xF3n *"),n(),g(16,"textarea",12),d(17,L,2,0,"div",10),n(),a(18,"div",13)(19,"button",14),p("click",function(){return t.goBack()}),l(20,"Cancelar"),n(),a(21,"button",15),d(22,H,1,0,"span",16),l(23),n()()()()()()),e&2){let m,f,u,b;r(4),x(t.esEdicion?"Editar Categor\xEDa":"Nueva Categor\xEDa"),r(2),s("formGroup",t.categoriaForm),r(),s("ngIf",t.error),r(4),v("is-invalid",((m=t.categoriaForm.get("nombre"))==null?null:m.invalid)&&((m=t.categoriaForm.get("nombre"))==null?null:m.touched)),r(),s("ngIf",(f=t.categoriaForm.get("nombre"))==null||f.errors==null?null:f.errors.required),r(4),v("is-invalid",((u=t.categoriaForm.get("descripcion"))==null?null:u.invalid)&&((u=t.categoriaForm.get("descripcion"))==null?null:u.touched)),r(),s("ngIf",(b=t.categoriaForm.get("descripcion"))==null||b.errors==null?null:b.errors.required),r(4),s("disabled",t.categoriaForm.invalid||t.submitting),r(),s("ngIf",t.submitting),r(),h(" ",t.submitting?"Guardando...":"Guardar Categor\xEDa"," ")}},dependencies:[N,k,V,O,M,T,G,P,q],styles:[".card[_ngcontent-%COMP%]{margin-top:2rem;margin-bottom:2rem}.card-header[_ngcontent-%COMP%]{padding:1rem}.form-label[_ngcontent-%COMP%]{font-weight:500}.invalid-feedback[_ngcontent-%COMP%]{display:block}"]})};export{A as CategoriaFormComponent};
