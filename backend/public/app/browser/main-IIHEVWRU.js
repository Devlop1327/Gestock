import{ka as me,la as se,ma as de,oa as pe,pa as ce,qa as ue,ra as ge,sa as fe}from"./chunk-QIZAOAIF.js";import{a as T}from"./chunk-COC5GXYX.js";import{a as oe,b as x,c as u,d as S,e as I,f as M,h as w,i as E,j as ie,k as ne,l as ae,n as k,o as y,q as P}from"./chunk-7YMBZQR7.js";import{D as c,G as m,H as B,I as n,J as r,K as d,M as b,N as R,O as a,P as N,Q as j,S as $,W as Y,aa as Z,ba as C,da as _,ea as J,fa as O,ga as K,ha as Q,ia as W,ka as X,la as F,ma as ee,na as te,oa as re,pa as le,w as l,y as p,z as h}from"./chunk-G2FCS2CP.js";import{a as z,b as U}from"./chunk-2NFLSA4Y.js";var xe=()=>["/register"];function Se(e,t){if(e&1&&(n(0,"div",23),a(1),r()),e&2){let o=R();l(),j(" ",o.error," ")}}function Ie(e,t){e&1&&(n(0,"div",24),a(1," El correo electr\xF3nico es requerido "),r())}function Me(e,t){e&1&&(n(0,"div",24),a(1," Ingrese un correo electr\xF3nico v\xE1lido "),r())}function we(e,t){e&1&&(n(0,"div",24),a(1," La contrase\xF1a es requerida "),r())}function Ee(e,t){e&1&&d(0,"span",25)}var q=class e{constructor(t,o,i){this.fb=t;this.authService=o;this.router=i;this.loginForm=this.fb.group({email:["",[u.required,u.email]],password:["",u.required],remember:[!1]})}loginForm;submitting=!1;error="";onSubmit(){this.loginForm.valid?(this.submitting=!0,this.error="",this.authService.login(this.loginForm.value).subscribe({next:t=>{t?.data?.token?(localStorage.setItem("auth_token",t.data.token),this.authService.currentUserSubject.next(t.data.user),this.router.navigate(["/productos"])):this.error="Respuesta inesperada del servidor."},error:t=>{console.error("Error de login:",t),this.error=t.error?.message||"Error al iniciar sesi\xF3n. Por favor, verifique sus credenciales.",this.submitting=!1},complete:()=>{this.submitting=!1}})):(this.error="Por favor, complete todos los campos correctamente.",Object.keys(this.loginForm.controls).forEach(t=>{let o=this.loginForm.get(t);o?.invalid&&o.markAsTouched()}))}static \u0275fac=function(o){return new(o||e)(p(y),p(T),p(F))};static \u0275cmp=h({type:e,selectors:[["app-login"]],decls:36,vars:14,consts:[[1,"login-container"],[1,"login-card"],[1,"login-header"],[1,"text-muted"],[3,"ngSubmit","formGroup"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"mb-3"],["for","email",1,"form-label"],["type","email","id","email","formControlName","email","placeholder","Ingresa tu correo electr\xF3nico","required","","autofocus","",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["for","password",1,"form-label"],["type","password","id","password","formControlName","password","placeholder","Ingresa tu contrase\xF1a","required","",1,"form-control"],[1,"mb-3","text-end"],["routerLink","/forgot-password"],[1,"mb-3","form-check"],["type","checkbox","id","remember","formControlName","remember",1,"form-check-input"],["for","remember",1,"form-check-label"],[1,"d-grid","gap-2"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],[1,"text-center","mt-3"],[1,"text-decoration-none",3,"routerLink"],["src","assets/images/Gestock.png","alt","Logo Sistema de Inventario",1,"img-fluid","rounded","shadow","d-block","mx-auto",2,"max-width","50px","max-height","50px","object-fit","contain","background","white","padding","0.1rem"],["role","alert",1,"alert","alert-danger"],[1,"invalid-feedback"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(o,i){if(o&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),a(4,"Sistema de Inventario"),r(),n(5,"p",3),a(6,"Inicia sesi\xF3n para continuar"),r()(),n(7,"form",4),b("ngSubmit",function(){return i.onSubmit()}),c(8,Se,2,1,"div",5),n(9,"div",6)(10,"label",7),a(11,"Correo Electr\xF3nico"),r(),d(12,"input",8),c(13,Ie,2,0,"div",9)(14,Me,2,0,"div",9),r(),n(15,"div",6)(16,"label",10),a(17,"Contrase\xF1a"),r(),d(18,"input",11),c(19,we,2,0,"div",9),r(),n(20,"div",12)(21,"a",13),a(22,"\xBFOlvidaste tu contrase\xF1a?"),r()(),n(23,"div",14),d(24,"input",15),n(25,"label",16),a(26,"Recordarme"),r()(),n(27,"div",17)(28,"button",18),c(29,Ee,1,0,"span",19),a(30),r()(),n(31,"div",20)(32,"a",21),a(33,"\xBFNo tienes una cuenta? Reg\xEDstrate"),r()(),d(34,"hr")(35,"img",22),r()()()),o&2){let s,g,v,f,G;l(7),m("formGroup",i.loginForm),l(),m("ngIf",i.error),l(4),B("is-invalid",((s=i.loginForm.get("email"))==null?null:s.invalid)&&((s=i.loginForm.get("email"))==null?null:s.touched)),l(),m("ngIf",(g=i.loginForm.get("email"))==null||g.errors==null?null:g.errors.required),l(),m("ngIf",(v=i.loginForm.get("email"))==null||v.errors==null?null:v.errors.email),l(4),B("is-invalid",((f=i.loginForm.get("password"))==null?null:f.invalid)&&((f=i.loginForm.get("password"))==null?null:f.touched)),l(),m("ngIf",(G=i.loginForm.get("password"))==null||G.errors==null?null:G.errors.required),l(9),m("disabled",i.loginForm.invalid||i.submitting),l(),m("ngIf",i.submitting),l(),j(" ",i.submitting?"Iniciando sesi\xF3n...":"Iniciar Sesi\xF3n"," "),l(2),m("routerLink",$(13,xe))}},dependencies:[_,C,P,M,x,oe,S,I,k,w,E,re,ee],styles:[".login-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#3b6ef6,#97999e)}.login-card[_ngcontent-%COMP%]{background:#fff;border-radius:1.25rem;box-shadow:0 8px 32px #1f268726;padding:2.5rem 2rem 2rem;max-width:400px;width:100%;display:flex;flex-direction:column;align-items:center}.login-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem}.login-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#2563eb;font-size:2rem;font-weight:700;margin-bottom:.5rem}.login-header[_ngcontent-%COMP%]   .text-muted[_ngcontent-%COMP%]{color:#6c757d;font-size:1.1rem}.form-label[_ngcontent-%COMP%]{font-weight:600;color:#222}.form-control[_ngcontent-%COMP%]{border-radius:.75rem;border:1.5px solid #d1d5db;padding:.9rem 1rem;font-size:1rem;background:#f8fafc;transition:border-color .2s}.form-control[_ngcontent-%COMP%]:focus{border-color:#2563eb;box-shadow:0 0 0 2px #2563eb26;background:#fff}.is-invalid[_ngcontent-%COMP%]{border-color:#e11d48!important}.invalid-feedback[_ngcontent-%COMP%]{color:#e11d48;font-size:.95rem;margin-top:.25rem}.form-check-input[_ngcontent-%COMP%]{border-radius:.5rem;border:1.5px solid #d1d5db}.form-check-label[_ngcontent-%COMP%]{color:#222;font-size:1rem}.btn-primary[_ngcontent-%COMP%]{background:#2563eb;border:none;border-radius:.75rem;font-weight:600;font-size:1.1rem;padding:.9rem 0;transition:background .2s}.btn-primary[_ngcontent-%COMP%]:hover, .btn-primary[_ngcontent-%COMP%]:focus{background:#1d4ed8}.d-grid.gap-2[_ngcontent-%COMP%]{margin-top:1.5rem}.text-center.mt-3[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#2563eb;font-weight:500;text-decoration:none;transition:color .2s}.text-center.mt-3[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#1d4ed8;text-decoration:underline}.img-fluid.rounded.shadow.d-block.mx-auto[_ngcontent-%COMP%]{margin-top:1rem;box-shadow:0 2px 8px #1f26871a;border-radius:.75rem;background:#fff;padding:.1rem}.alert-danger[_ngcontent-%COMP%]{border-left:4px solid #2563eb;background-color:#e7f1ff;color:#2563eb;border-color:#2563eb;font-weight:500}@media (max-width: 600px){.login-card[_ngcontent-%COMP%]{padding:1.5rem .5rem}.login-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.3rem}}"]})};function Pe(e,t){e&1&&(n(0,"div",14),a(1,"El nombre es requerido"),r())}function Re(e,t){e&1&&(n(0,"div",14),a(1,"El correo es requerido"),r())}function Ne(e,t){e&1&&(n(0,"div",14),a(1,"La contrase\xF1a es requerida"),r())}function Oe(e,t){e&1&&(n(0,"div",14),a(1,"La confirmaci\xF3n de la contrase\xF1a es requerida"),r())}function ke(e,t){if(e&1&&(n(0,"option",15),a(1),r()),e&2){let o=t.$implicit;m("value",o.id),l(),N(o.id)}}var A=class e{constructor(t,o,i,s){this.fb=t;this.router=o;this.authService=i;this.http=s;this.registerForm=this.fb.group({name:["",u.required],email:["",[u.required,u.email]],password:["",u.required],password_confirmation:["",u.required],role_id:[""]})}registerForm;roles=[];ngOnInit(){this.http.get(`${le.apiUrl}/roles`).subscribe({next:t=>this.roles=t,error:()=>this.roles=[]})}onSubmit(){if(this.registerForm.valid){let t=U(z({},this.registerForm.value),{role_id:Number(this.registerForm.value.role_id)});this.authService.register(t).subscribe({next:()=>{alert("Registro exitoso. Ahora puedes iniciar sesi\xF3n."),this.router.navigate(["/login"])},error:o=>{console.error("Error al registrar:",o),alert(o.error?.message||"Error al registrar")}})}}static \u0275fac=function(o){return new(o||e)(p(y),p(F),p(T),p(O))};static \u0275cmp=h({type:e,selectors:[["app-register"]],decls:36,vars:7,consts:[[1,"register-container"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["formControlName","name","placeholder","Ingresa tu nombre",1,"form-control"],["class","text-danger",4,"ngIf"],["formControlName","email","placeholder","Ingresa tu correo electr\xF3nico",1,"form-control"],["type","password","formControlName","password","placeholder","Ingresa tu contrase\xF1a",1,"form-control"],["type","password","formControlName","password_confirmation","placeholder","Repite tu contrase\xF1a",1,"form-control"],["formControlName","role_id",1,"form-control"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-primary","w-100",3,"disabled"],[1,"mt-3"],["href","/login"],[1,"text-danger"],[3,"value"]],template:function(o,i){if(o&1&&(n(0,"div",0)(1,"h2"),a(2,"Registro de Usuario"),r(),n(3,"form",1),b("ngSubmit",function(){return i.onSubmit()}),n(4,"div",2)(5,"label"),a(6,"Nombre"),r(),d(7,"input",3),c(8,Pe,2,0,"div",4),r(),n(9,"div",2)(10,"label"),a(11,"Correo Electr\xF3nico"),r(),d(12,"input",5),c(13,Re,2,0,"div",4),r(),n(14,"div",2)(15,"label"),a(16,"Contrase\xF1a"),r(),d(17,"input",6),c(18,Ne,2,0,"div",4),r(),n(19,"div",2)(20,"label"),a(21,"Confirmar Contrase\xF1a"),r(),d(22,"input",7),c(23,Oe,2,0,"div",4),r(),n(24,"div",2)(25,"label"),a(26,"Rol"),r(),n(27,"select",8)(28,"option",9),a(29,"Selecciona un rol"),r(),c(30,ke,2,2,"option",10),r()(),n(31,"button",11),a(32,"Registrarse"),r()(),n(33,"div",12)(34,"a",13),a(35,"\xBFYa tienes cuenta? Inicia sesi\xF3n"),r()()()),o&2){let s,g,v,f;l(3),m("formGroup",i.registerForm),l(5),m("ngIf",((s=i.registerForm.get("name"))==null?null:s.invalid)&&((s=i.registerForm.get("name"))==null?null:s.touched)),l(5),m("ngIf",((g=i.registerForm.get("email"))==null?null:g.invalid)&&((g=i.registerForm.get("email"))==null?null:g.touched)),l(5),m("ngIf",((v=i.registerForm.get("password"))==null?null:v.invalid)&&((v=i.registerForm.get("password"))==null?null:v.touched)),l(5),m("ngIf",((f=i.registerForm.get("password_confirmation"))==null?null:f.invalid)&&((f=i.registerForm.get("password_confirmation"))==null?null:f.touched)),l(7),m("ngForOf",i.roles),l(),m("disabled",i.registerForm.invalid)}},dependencies:[_,Z,C,P,M,ne,ae,x,ie,S,I,w,E],styles:[".register-container[_ngcontent-%COMP%]{max-width:400px;margin:3rem auto;background:#fff;padding:2rem;border-radius:1rem;box-shadow:0 0 20px #0001}h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:1.5rem}"]})};function Te(e,t){e&1&&(n(0,"mat-error"),a(1,"Requerido"),r())}function qe(e,t){e&1&&(n(0,"mat-error"),a(1,"Correo inv\xE1lido"),r())}function Ae(e,t){if(e&1&&(n(0,"div",7),a(1),r()),e&2){let o=R();l(),N(o.error)}}function Le(e,t){if(e&1&&(n(0,"div",8),a(1),r()),e&2){let o=R();l(),N(o.message)}}var L=class e{constructor(t,o){this.fb=t;this.http=o;this.form=this.fb.group({email:["",[u.required,u.email]]})}form;loading=!1;message=null;error=null;submit(){this.form.invalid||(this.loading=!0,this.message=null,this.error=null,this.http.post("/api/forgot-password",this.form.value).subscribe({next:t=>{this.message=t.message||"\xA1Revisa tu correo para el enlace de recuperaci\xF3n!",this.loading=!1},error:t=>{this.error=t.error?.message||"No se pudo enviar el correo.",this.loading=!1}}))}static \u0275fac=function(o){return new(o||e)(p(y),p(O))};static \u0275cmp=h({type:e,selectors:[["app-forgot-password"]],decls:13,vars:6,consts:[[3,"ngSubmit","formGroup"],["appearance","fill",1,"w-100"],["matInput","","type","email","formControlName","email","required",""],[4,"ngIf"],["class","error",4,"ngIf"],["class","success",4,"ngIf"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"error"],[1,"success"]],template:function(o,i){if(o&1&&(n(0,"h2"),a(1,"\xBFOlvidaste tu contrase\xF1a?"),r(),n(2,"form",0),b("ngSubmit",function(){return i.submit()}),n(3,"mat-form-field",1)(4,"mat-label"),a(5,"Correo electr\xF3nico"),r(),d(6,"input",2),c(7,Te,2,0,"mat-error",3)(8,qe,2,0,"mat-error",3),r(),c(9,Ae,2,1,"div",4)(10,Le,2,1,"div",5),n(11,"button",6),a(12,"Enviar enlace"),r()()),o&2){let s,g;l(2),m("formGroup",i.form),l(5),m("ngIf",(s=i.form.get("email"))==null?null:s.hasError("required")),l(),m("ngIf",(g=i.form.get("email"))==null?null:g.hasError("email")),l(),m("ngIf",i.error),l(),m("ngIf",i.message),l(),m("disabled",i.loading||i.form.invalid)}},dependencies:[_,C,P,M,x,S,I,k,w,E,pe,de,me,se,ue,ce,fe,ge],styles:[".w-100[_ngcontent-%COMP%]{width:100%}.error[_ngcontent-%COMP%]{color:#b71c1c;margin:8px 0}.success[_ngcontent-%COMP%]{color:#388e3c;margin:8px 0}"]})};var Ce=[{path:"login",component:q},{path:"register",component:A},{path:"forgot-password",component:L},{path:"",redirectTo:"/login",pathMatch:"full"},{path:"productos",loadChildren:()=>import("./chunk-PFCB7LGA.js").then(e=>e.productosRoutes)},{path:"categorias",loadChildren:()=>import("./chunk-URNGNUOT.js").then(e=>e.categoriasRoutes)},{path:"admin",loadChildren:()=>import("./chunk-PP22RGUJ.js").then(e=>e.adminRoutes)},{path:"**",redirectTo:"/productos",pathMatch:"full"}];var De=(e,t)=>{let o=localStorage.getItem("auth_token");return o&&(e=e.clone({setHeaders:{Authorization:`Bearer ${o}`}})),t(e)},_e={providers:[Y({eventCoalescing:!0}),te(Ce),K(Q([De]))]};var D=class e{constructor(t){this.router=t;this.router.events.subscribe(o=>{if(o instanceof W){let i=o.urlAfterRedirects;this.isLoggedIn=!!localStorage.getItem("auth_token")}}),this.isLoggedIn=!!localStorage.getItem("auth_token")}title="inventario-app";isLoggedIn=!1;static \u0275fac=function(o){return new(o||e)(p(F))};static \u0275cmp=h({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(o,i){o&1&&d(0,"router-outlet")},dependencies:[X],encapsulation:2})};J(D,_e).catch(e=>console.error(e));
